CREATE DATABASE IF NOT EXISTS test;
USE test;

CREATE TABLE IF NOT EXISTS users
(
    id         BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    login      VARCHAR(128)    NOT NULL UNIQUE KEY,
    password   VARCHAR(255)    NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME  DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS articles
(
    id         BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    author_id  BIGINT UNSIGNED NOT NULL,
    title      VARCHAR(512)    NOT NULL,
    image_url  VARCHAR(256)    NOT NULL,
    text       TEXT            NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME  DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    FOREIGN KEY (author_id) REFERENCES users(id)
);

CREATE TABLE IF NOT EXISTS article_comments
(
    id         BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    article_id BIGINT UNSIGNED NOT NULL,
    name       VARCHAR(128),
    url        VARCHAR(256),
    email      VARCHAR(128),
    text       TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME  DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    FOREIGN KEY (article_id) REFERENCES articles(id)
);